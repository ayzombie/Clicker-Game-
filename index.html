<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clicker Game with Bouncing Balls & Save</title>
<style>
  body {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background: linear-gradient(to right, #74ebd5, #acb6e5);
    font-family: Arial, sans-serif;
    overflow: hidden;
    margin: 0;
  }
  h1 { font-size: 2rem; margin: 10px; }
  #score, #cps { font-size: 1.5rem; margin: 10px; font-weight: bold; }
  button {
    padding: 10px 20px;
    font-size: 1rem;
    border: none;
    border-radius: 10px;
    background: #ff6f61;
    color: white;
    cursor: pointer;
    margin: 5px;
    transition: transform 0.1s ease, background 0.2s;
  }
  button:hover { background: #ff4b3e; }
  button:active { transform: scale(0.9); }
  .shop { margin-top: 10px; display: flex; flex-direction: column; align-items: center; }
  canvas { position: absolute; top: 0; left: 0; z-index: -1; }
</style>
</head>
<body>

<h1>Clicker Game</h1>
<div id="score">Score: 0</div>
<button onclick="addPoint()">Click Me!</button>
<div id="cps">CPS: 0</div>

<div class="shop">
  <h2>Shop</h2>
  <button id="upgradeBtn" onclick="buyUpgrade()">Upgrade Click (+1) — Cost: 10</button>
  <button id="autoClickerBtn" onclick="buyAutoClicker()">Upgrade Ball Speed — Cost: 50</button>
  <button id="ballSpawnerBtn" onclick="buyBallSpawner()">Add Ball — Cost: 200</button>
  <button id="ballValueBtn" onclick="buyBallValue()">Increase Ball Value — Cost: 500</button>
  <button onclick="restartGame()">Restart Game</button>

</div>

<canvas id="gameCanvas"></canvas>

<script>
let score = 0;
let pointsPerClick = 1;
let upgradeCost = 10;

let autoClickerLevel = 1;
let autoClickerCost = 50;

let ballSpawnerCount = 1;
let ballSpawnerCost = 200;

let ballValue = 1;
let ballValueCost = 500;

let balls = [];

const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");


function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

class Ball {
  constructor(x = Math.random() * canvas.width, y = Math.random() * canvas.height, dx = null, dy = null) {
    this.x = x;
    this.y = y;
    this.dx = dx !== null ? dx : (Math.random() * 2 - 1) * autoClickerLevel;
    this.dy = dy !== null ? dy : (Math.random() * 2 - 1) * autoClickerLevel;
    this.radius = 15;
  }

  update() {
    this.x += this.dx;
    this.y += this.dy;

    if (this.x <= 0 || this.x >= canvas.width) {
      this.dx *= -1;
      score += ballValue;
      updateScore();
    }
    if (this.y <= 0 || this.y >= canvas.height) {
      this.dy *= -1;
      score += ballValue;
      updateScore();
    }
  }
}
  class Square {
  constructor(x = Math.random() * canvas.width, y = Math.random() * canvas.height, dx = null, dy = null) {
    this.x = x;
    this.y = y;
    this.dx = dx !== null ? dx : (Math.random() * 2 - 1) * autoClickerLevel;
    this.dy = dy !== null ? dy : (Math.random() * 2 - 1) * autoClickerLevel;
    this.radius = 10;
  }

  update() {
    this.x += this.dx;
    this.y += this.dy;

    if (this.x <= 0 || this.x >= canvas.width) {
      this.dx *= -1;
      score += ballValue;
      updateScore();
    }
    if (this.y <= 0 || this.y >= canvas.height) {
      this.dy *= -1;
      score += ballValue;
      updateScore();
    }
  }

  draw() {
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
    ctx.fillStyle = "#ff6f61";
    ctx.fill();
    ctx.closePath();
  }
}

// Functions for click and upgrades
function addPoint() { score += pointsPerClick; updateScore(); }

function buyUpgrade() {
  if (score >= upgradeCost) {
    score -= upgradeCost;
    pointsPerClick++;
    upgradeCost = Math.floor(upgradeCost * 1.05);
    updateShop();
    updateScore();
  }
}

function buyAutoClicker() {
  if (score >= autoClickerCost) {
    score -= autoClickerCost;
    autoClickerLevel++;
    autoClickerCost = Math.floor(autoClickerCost * 1.5);
    balls.forEach(ball => { ball.dx *= 1.2; ball.dy *= 1.2; });
    updateShop();
    updateScore();
  }
}

function buyBallSpawner() {
  if (score >= ballSpawnerCost) {
    score -= ballSpawnerCost;
    ballSpawnerCount++;
    ballSpawnerCost = Math.floor(ballSpawnerCost * 1.01);
    balls.push(new Ball());
    updateShop();
    updateScore();
  }
}

function buyBallValue() {
  if (score >= ballValueCost) {
    score -= ballValueCost;
    ballValue++;
    ballValueCost = Math.floor(ballValueCost * 2);
    updateShop();
    updateScore();
  }
}

function updateShop() {
  document.getElementById("upgradeBtn").innerText = "Upgrade Click (+" + pointsPerClick + ") — Cost: " + upgradeCost;
  document.getElementById("autoClickerBtn").innerText = "Upgrade Ball Speed (Lv " + autoClickerLevel + ") — Cost: " + autoClickerCost;
  document.getElementById("ballSpawnerBtn").innerText = "Add Ball (Now " + ballSpawnerCount + ") — Cost: " + ballSpawnerCost;
  document.getElementById("ballValueBtn").innerText = "Increase Ball Value (Now " + ballValue + ") — Cost: " + ballValueCost;
}

function updateScore() {
  document.getElementById("score").innerText = "Score: " + score;
  document.getElementById("cps").innerText = "Balls: " + balls.length + " | Speed Lv: " + autoClickerLevel + " | Ball Value: " + ballValue;
  saveGame();
}

// SAVE / LOAD
function saveGame() {
  const saveData = {
    score, pointsPerClick, upgradeCost,
    autoClickerLevel, autoClickerCost,
    ballSpawnerCount, ballSpawnerCost,
    ballValue, ballValueCost,
    balls: balls.map(b => ({x: b.x, y: b.y, dx: b.dx, dy: b.dy}))
  };
  localStorage.setItem("clickerSave", JSON.stringify(saveData));
}

function loadGame() {
  const saved = JSON.parse(localStorage.getItem("clickerSave"));
  if (saved) {
    score = saved.score || 0;
    pointsPerClick = saved.pointsPerClick || 1;
    upgradeCost = saved.upgradeCost || 10;
    autoClickerLevel = saved.autoClickerLevel || 1;
    autoClickerCost = saved.autoClickerCost || 50;
    ballSpawnerCount = saved.ballSpawnerCount || 1;
    ballSpawnerCost = saved.ballSpawnerCost || 200;
    ballValue = saved.ballValue || 1;
    ballValueCost = saved.ballValueCost || 500;

    balls = [];
    if (saved.balls && saved.balls.length > 0) {
      saved.balls.forEach(b => balls.push(new Ball(b.x, b.y, b.dx, b.dy)));
    } else {
      for (let i = 0; i < ballSpawnerCount; i++) balls.push(new Ball());
    }
  } else {
    for (let i = 0; i < ballSpawnerCount; i++) balls.push(new Ball());
  }
  updateShop();
  updateScore();
}

function restartGame() {
  score = 0;
  pointsPerClick = 1;
  upgradeCost = 10;
  autoClickerLevel = 1;
  autoClickerCost = 50;
  ballSpawnerCount = 1;
  ballSpawnerCost = 200;
  ballValue = 1;
  ballValueCost = 500;

  balls.forEach(b => b.el?.remove()); // remove any existing balls
  balls = [new Ball()]; // start with 1 ball

  updateShop();
  updateScore();
  saveGame();
}

// Game loop
function gameLoop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  balls.forEach(ball => { ball.update(); ball.draw(); });
  requestAnimationFrame(gameLoop);
}

loadGame();
gameLoop();
</script>
</body>
</html>
